

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2.1. SQL &#8212; Machine Learning book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4_SQL_noSQL/1_SQL';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.22. noSQL" href="2_noSQL.html" />
    <link rel="prev" title="2. SQL/noSQL" href="0_toc.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../_jupyter_book_files/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../_jupyter_book_files/intro.html">
                    Welcome to Dat’s Notebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Process Modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_eda.html">1. Statistic and EDA</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-0.html">1.1. Data Analyst Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-1.html">1.2. Read datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-2.html">1.3. Explore data analysis (EDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-3.html">1.4. Description statistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-4.html">1.5. Inferential statistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-5.html">1.6. Kiểm định giả thuyết (Hypothesis testing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-6.html">1.7. ANOVA</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_fe.html">2. Feature Engineering</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-1.html">2.1. Custom Transforms Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-2.html">2.2. Feature extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-3.html">2.3. Variable Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-4.html">2.4. Missing Imputation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-5.html">2.5. Categorical Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-6.html">2.6. Feature transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-7.html">2.7. Discretisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-8.html">2.8. Outliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-9.html">2.9. Feature scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-10.html">2.10. Feature selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_imb.html">3. Imbalance Dataset Handling</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-1.html">3.1. Data-level approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-2.html">3.2. Cost sensitive approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-3.html">3.3. Ensemble approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-4.html">3.4. Ensemble approaches</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_fs.html">4. Feature Selection</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-1.html">4.1. Filter methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-2.html">4.2. Wrapped methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-3.html">4.3. Embedded methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-4.html">4.4. Hybrid methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-5.html">4.5. Feature decomposition</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_eva.html">5. Evaluation Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-0.html">5.1. Define scorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-1.html">5.2. Classification metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-2.html">5.3. Regression metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-3.html">5.4. Clustering metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-4.html">5.5. Pairwise metrics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/6_Models_monitoring_production-0.html">6. Model Monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/6_Models_monitoring_production-1.html">6.7. Functional level monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/6_Models_monitoring_production-2.html">6.8. Operational level monitoring</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ML/DL Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_ml_su.html">1. ML Supervised Learning</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-0.html">1.1. Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-1.html">1.2. Naive Bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-2.html">1.3. Discriminant Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-3.html">1.4. Stochastic Gradient Descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-4.html">1.5. Support Vector Machines (SVM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-5.html">1.6. Nearest neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-6.html">1.7. Tree-base model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-7.html">1.8. Ensemble learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-8.html">1.9. Multi-class and multi-output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-9.html">1.10. Neural network models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_ml_unsu.html">2. ML Unsupervised Learning</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-0.html">2.1. Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-1.html">2.2. Decomposing components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-2.html">2.3. Manifold learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-3.html">2.4. Novelty and Outlier Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-4.html">2.5. Neural network</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_dl.html">3. Deep Learning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_DL_Algorithms-0.html">3.1. Neural Network</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">My Modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../3_Mathematics/0_toc.html">1. Mathematics</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/1_Linear_algebra.html">1.1. Linear algebra</a></li>



<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/2_Calculus_and_optimization.html">1.5. Calculus and optimization</a></li>






<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/3_Distribution_and_statistic.html">1.12. Distribution and statistics</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/4_Information_theory.html">1.14. Information theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/5_Graph_theory.html">1.15. Graph theory</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="0_toc.html">2. SQL/NoSQL</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.1. SQL</a></li>




















<li class="toctree-l2"><a class="reference internal" href="2_noSQL.html">2.22. noSQL</a></li>




</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2_My_Modules/1_Data_Cleaning.html">3. Data cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_My_Modules/2_Connection.html">4. Data connection</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/datkt1998/DS_learning_book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/4_SQL_noSQL/1_SQL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SQL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">2.1. SQL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cau-lenh-dcl">2.2. Câu lệnh DCL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cau-lenh-ddl">2.3. Câu lệnh DDL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#insert-them-du-lieu-vao-trong-table">2.4. <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> : THÊM DỮ LIỆU VÀO TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#update-sua-row-trong-table">2.5. <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> : SỬA ROW TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-xoa-row-trong-table">2.6. <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> : XÓA ROW TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#truncate-xoa-toan-bo-data-trong-table">2.7. <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>: XÓA TOÀN BỘ DATA TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#type-of-join">2.8. 1. Type of Join</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#natural-join">2.9. 2. Natural Join</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.9.1. 2.1 <code class="docutils literal notranslate"><span class="pre">Natural</span> <span class="pre">Join</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-clause-chi-dinh-1-or-1-vai-columns-cung-ten-de-match">2.9.2. 2.2 <code class="docutils literal notranslate"><span class="pre">USING</span></code> Clause : Chỉ định 1 or 1 vài columns cùng tên để match</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#on-clause-join-tren-1-conditions-nao-do">2.9.3. 2.3 <code class="docutils literal notranslate"><span class="pre">ON</span></code> Clause: JOIN TRÊN 1 CONDITIONS NÀO ĐÓ</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#self-join-join-cac-du-lieu-trong-cung-1-bang">2.10. 3. Self-Join : Join các dữ liệu trong cùng 1 bảng</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nonequijoins">2.11. 4. Nonequijoins</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-join">2.12. 5. Outer Join :</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cartesian-product-cross-join">2.13. 6. Cartesian Product : <code class="docutils literal notranslate"><span class="pre">Cross</span> <span class="pre">Join</span> </code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creat-table">2.14. 1. Creat table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-table">2.15. 2. Select table</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seclect-distinct-select-loai-bo-trung-lap">2.15.1. 2.1 SECLECT DISTINCT : select loại bỏ trùng lặp</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-where-filter-rows">2.15.2. 2.2 Select + where : filter rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-order-by-sorted">2.15.3. 2.3 Select + ORDER BY : sorted</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-group-by-grouping">2.15.4. 2.4 Select + GROUP BY : grouping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-group-by-having-tao-bo-loc-sau-khi-da-chay-group-by">2.15.5. 2.3 Select + GROUP BY + HAVING : tạo bộ lọc sau khi đã chạy GROUP BY</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#subquery">2.16. 3. SUBQUERY</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#set-operator-ghep-bang-them-row-theo-cot">2.17. 4. SET OPERATOR (ghép bảng = thêm row theo cột)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.18. 1. Creat table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.19. 2. Select table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#single-row-function">2.20. 1. Single-row Function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#character-functions">2.20.1. 1.1 Character Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-functions">2.20.2. 1.2 Number Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#date-functions">2.20.3. 1.3 Date Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-functions">2.20.4. 1.4 Conversion Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-char-thuong-dung-cho-out-put-data">2.20.4.1. <code class="docutils literal notranslate"><span class="pre">To_CHAR</span></code> thường dùng cho out-put data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-num-or-to-date-thuong-dung-cho-in-put-data">2.20.4.2. <code class="docutils literal notranslate"><span class="pre">To_NUM</span></code> or <code class="docutils literal notranslate"><span class="pre">TO_DATE</span></code> thường dùng cho in-put data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#netting-functions">2.20.5. 1.5 Netting Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-functions">2.20.6. 1.6 General Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-expressions">2.20.7. 1.7 Conditional expressions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-rows-aggregate-function">2.21. 2. Multiple-rows/Aggregate Function</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sql">
<h1><span class="section-number">2.1. </span>SQL<a class="headerlink" href="#sql" title="Permalink to this heading">#</a></h1>
<p>read a local .csv or .xlsx file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Use to import pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#Use to import the file into google Colab drive</span>
<span class="c1"># from google.colab import files </span>

<span class="c1">#Use to import io, which opens the file from the Colab drive</span>
<span class="c1"># import io</span>

<span class="kn">import</span> <span class="nn">cx_Oracle</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will open a widget when run that will enable you to browse the files on your local storage drive.</span>
<span class="n">uploaded</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
     <input type="file" id="files-516f972c-91bc-4ae8-a360-e34b59147eb3" name="files[]" multiple disabled />
     <output id="result-516f972c-91bc-4ae8-a360-e34b59147eb3">
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
      <script src="/nbextensions/google.colab/files.js"></script> </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving datatest2.csv to datatest2.csv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now use the below code to read the csv in pandas&#39; dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">uploaded</span><span class="p">[</span><span class="s1">&#39;datatest2.csv&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stockid</th>
      <th>Stock</th>
      <th>day_trading</th>
      <th>close_p</th>
      <th>volume_s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB43850</td>
      <td>ACB</td>
      <td>1/20/2020</td>
      <td>18.50</td>
      <td>1300000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB43849</td>
      <td>ACB</td>
      <td>1/19/2020</td>
      <td>19.50</td>
      <td>1257000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB43848</td>
      <td>ACB</td>
      <td>1/18/2020</td>
      <td>20.40</td>
      <td>1214000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB43847</td>
      <td>ACB</td>
      <td>1/17/2020</td>
      <td>21.37</td>
      <td>1171000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB43846</td>
      <td>ACB</td>
      <td>1/16/2020</td>
      <td>22.32</td>
      <td>1128000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB43845</td>
      <td>ACB</td>
      <td>1/15/2020</td>
      <td>23.27</td>
      <td>1085000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB43844</td>
      <td>ACB</td>
      <td>1/14/2020</td>
      <td>24.22</td>
      <td>1042000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AVM43843</td>
      <td>AVM</td>
      <td>1/13/2020</td>
      <td>25.17</td>
      <td>999000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AVM43842</td>
      <td>AVM</td>
      <td>1/12/2020</td>
      <td>26.12</td>
      <td>956000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AVM43841</td>
      <td>AVM</td>
      <td>1/11/2020</td>
      <td>27.07</td>
      <td>913000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM43840</td>
      <td>AVM</td>
      <td>1/10/2020</td>
      <td>28.02</td>
      <td>870000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM43839</td>
      <td>AVM</td>
      <td>1/9/2020</td>
      <td>28.97</td>
      <td>827000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM43838</td>
      <td>AVM</td>
      <td>1/8/2020</td>
      <td>29.92</td>
      <td>784000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM43837</td>
      <td>AVM</td>
      <td>1/7/2020</td>
      <td>30.87</td>
      <td>741000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>AVM43836</td>
      <td>AVM</td>
      <td>1/6/2020</td>
      <td>31.82</td>
      <td>698000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>AVM43835</td>
      <td>AVM</td>
      <td>1/5/2020</td>
      <td>32.77</td>
      <td>655000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>AVM43834</td>
      <td>AVM</td>
      <td>1/4/2020</td>
      <td>33.72</td>
      <td>612000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Connect to Oracle database</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#chạy code ko cần pandas để hiển thị</span>
<span class="k">with</span> <span class="n">cx_Oracle</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;SYSTEM/21061998@localhost/db12c&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">query</span><span class="o">=</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from allstocktest&quot;</span><span class="p">)</span> <span class="c1"># viết SQL query code</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># chạy code query ở sql</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Connection</span><span class="p">(</span><span class="n">cx_Oracle</span><span class="o">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Connection</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cursor</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s2">&quot;SYSTEM/21061998@localhost/db12c&quot;</span><span class="p">)</span>
<span class="n">sql</span><span class="o">=</span><span class="s2">&quot;select * from allstocktest&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCKID</th>
      <th>STOCK</th>
      <th>DAY_TRADING</th>
      <th>CLOSE_P</th>
      <th>VOLUME_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB43850</td>
      <td>ACB</td>
      <td>2020-01-20</td>
      <td>19</td>
      <td>1300000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB43849</td>
      <td>ACB</td>
      <td>2020-01-19</td>
      <td>20</td>
      <td>1257000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB43848</td>
      <td>ACB</td>
      <td>2020-01-18</td>
      <td>20</td>
      <td>1214000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB43847</td>
      <td>ACB</td>
      <td>2020-01-17</td>
      <td>21</td>
      <td>1171000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB43846</td>
      <td>ACB</td>
      <td>2020-01-16</td>
      <td>22</td>
      <td>1128000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB43845</td>
      <td>ACB</td>
      <td>2020-01-15</td>
      <td>23</td>
      <td>1085000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB43844</td>
      <td>ACB</td>
      <td>2020-01-14</td>
      <td>24</td>
      <td>1042000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AVM43843</td>
      <td>AVM</td>
      <td>2020-01-13</td>
      <td>25</td>
      <td>999000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AVM43842</td>
      <td>AVM</td>
      <td>2020-01-12</td>
      <td>26</td>
      <td>956000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AVM43841</td>
      <td>AVM</td>
      <td>2020-01-11</td>
      <td>27</td>
      <td>913000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM43840</td>
      <td>AVM</td>
      <td>2020-01-10</td>
      <td>28</td>
      <td>870000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM43839</td>
      <td>AVM</td>
      <td>2020-01-09</td>
      <td>29</td>
      <td>827000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM43838</td>
      <td>AVM</td>
      <td>2020-01-08</td>
      <td>30</td>
      <td>784000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM43837</td>
      <td>AVM</td>
      <td>2020-01-07</td>
      <td>31</td>
      <td>741000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>AVM43836</td>
      <td>AVM</td>
      <td>2020-01-06</td>
      <td>32</td>
      <td>698000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>AVM43835</td>
      <td>AVM</td>
      <td>2020-01-05</td>
      <td>33</td>
      <td>655000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>AVM43834</td>
      <td>AVM</td>
      <td>2020-01-04</td>
      <td>34</td>
      <td>612000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sql2</span><span class="o">=</span><span class="s2">&quot;select * from allstocks&quot;</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">sql2</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STT_S</th>
      <th>ID_S</th>
      <th>STOCK</th>
      <th>SECTOR_S</th>
      <th>TRADING_DAY</th>
      <th>RETURN_P</th>
      <th>DELTA_P</th>
      <th>CLOSE_P</th>
      <th>VOLUME_S</th>
      <th>REFE_P</th>
      <th>OPEN_P</th>
      <th>HIGH_P</th>
      <th>LOW_P</th>
      <th>PUT_THROUGH</th>
      <th>FOREIGN_SELL</th>
      <th>FOREIGN_BUY</th>
      <th>VALUE_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>A32</td>
      <td>None</td>
      <td>2019-12-31</td>
      <td>0%</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>A32</td>
      <td>None</td>
      <td>2019-12-30</td>
      <td>0%</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>A32</td>
      <td>None</td>
      <td>2019-12-27</td>
      <td>0%</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>A32</td>
      <td>None</td>
      <td>2019-12-26</td>
      <td>0%</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5</td>
      <td>A32</td>
      <td>None</td>
      <td>2019-12-25</td>
      <td>0%</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>khi kết nối tới database sẽ bắt đầu 1 session, trong session bao gồm nhiều transaction</p></li>
<li><p>Các công lệnh DCL hoặc DDL sẽ end transaction</p></li>
<li><p>Câu lệnh DCL sẽ end session</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cau-lenh-dcl">
<h1><span class="section-number">2.2. </span>Câu lệnh DCL<a class="headerlink" href="#cau-lenh-dcl" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Câu lệnh kết thúc transaction, đồng thời mở ra 1 transaction mới:</strong> <code class="docutils literal notranslate"><span class="pre">COMMIT</span></code></p></li>
<li><p><strong>Hủy bỏ thao tác transaction này, mở ra 1 transaction mới</strong> <code class="docutils literal notranslate"><span class="pre">ROLLBACK</span></code> [TO savepoint_name]</p></li>
<li><p><strong>Tạo bookmark điểm <code class="docutils literal notranslate"><span class="pre">COMMIT</span></code> or <code class="docutils literal notranslate"><span class="pre">ROLLBACK</span></code></strong> <code class="docutils literal notranslate"><span class="pre">SAVEPOINT</span> <span class="pre">savepoint_name</span></code></p></li>
</ul>
<div class="highlight-SQL notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="p">)</span><span class="w"></span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_col1</span><span class="p">,</span><span class="w"> </span><span class="n">to_col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">TABLE1</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="w"></span>
<span class="n">SAVEPOINT</span><span class="w"> </span><span class="n">insert_done</span><span class="p">;</span><span class="w"></span>

<span class="k">DELETE</span><span class="w"> </span><span class="p">[</span><span class="k">FROM</span><span class="p">]</span><span class="w"> </span><span class="k">table</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="w"></span>
<span class="n">SAVEPOINT</span><span class="w"> </span><span class="n">delete_done</span><span class="p">;</span><span class="w"></span>

<span class="k">ROLLBACK</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">insert_done</span><span class="w"></span>
<span class="k">ROLLBACK</span><span class="w"></span>
<span class="k">COMMIT</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cau-lenh-ddl">
<h1><span class="section-number">2.3. </span>Câu lệnh DDL<a class="headerlink" href="#cau-lenh-ddl" title="Permalink to this heading">#</a></h1>
<p>ví dụ như <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="insert-them-du-lieu-vao-trong-table">
<h1><span class="section-number">2.4. </span><code class="docutils literal notranslate"><span class="pre">INSERT</span></code> : THÊM DỮ LIỆU VÀO TRONG TABLE<a class="headerlink" href="#insert-them-du-lieu-vao-trong-table" title="Permalink to this heading">#</a></h1>
<p><strong>1.cú pháp insert từng row</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="p">,...)</span><span class="w"></span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">val1</span><span class="p">,</span><span class="n">val2</span><span class="p">,...)</span><span class="w"></span>
</pre></div>
</div>
<p><strong>2.cú pháp insert nhiều row theo bảng có sẵn</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="p">)</span><span class="w"></span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_col1</span><span class="p">,</span><span class="w"> </span><span class="n">to_col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">TABLE1</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="update-sua-row-trong-table">
<h1><span class="section-number">2.5. </span><code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> : SỬA ROW TRONG TABLE<a class="headerlink" href="#update-sua-row-trong-table" title="Permalink to this heading">#</a></h1>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="k">table</span><span class="w"></span>
<span class="k">SET</span><span class="w"> </span><span class="n">col1</span><span class="o">=</span><span class="n">value2</span><span class="p">,</span><span class="n">col2</span><span class="o">=</span><span class="n">value2</span><span class="p">,...</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="w"> </span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">WHERE</span></code> điệu kiện các row được update</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="delete-xoa-row-trong-table">
<h1><span class="section-number">2.6. </span><code class="docutils literal notranslate"><span class="pre">DELETE</span></code> : XÓA ROW TRONG TABLE<a class="headerlink" href="#delete-xoa-row-trong-table" title="Permalink to this heading">#</a></h1>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DELETE</span><span class="w"> </span><span class="p">[</span><span class="k">FROM</span><span class="p">]</span><span class="w"> </span><span class="k">table</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="truncate-xoa-toan-bo-data-trong-table">
<h1><span class="section-number">2.7. </span><code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>: XÓA TOÀN BỘ DATA TRONG TABLE<a class="headerlink" href="#truncate-xoa-toan-bo-data-trong-table" title="Permalink to this heading">#</a></h1>
<p>TƯƠNG ĐƯƠNG với <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> mà không có <code class="docutils literal notranslate"><span class="pre">WHERE</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">table</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">connect</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">conn</span><span class="o">=</span><span class="n">connect</span><span class="o">.</span><span class="n">connection</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="type-of-join">
<h1><span class="section-number">2.8. </span>1. Type of Join<a class="headerlink" href="#type-of-join" title="Permalink to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="natural-join">
<h1><span class="section-number">2.9. </span>2. Natural Join<a class="headerlink" href="#natural-join" title="Permalink to this heading">#</a></h1>
<section id="id1">
<h2><span class="section-number">2.9.1. </span>2.1 <code class="docutils literal notranslate"><span class="pre">Natural</span> <span class="pre">Join</span></code><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p><strong>Join tự động 2 table với những column cùng tên với nhau</strong></p>
<ul class="simple">
<li><p>Nếu 2 bảng có 2 tên giống nhau nhưng type data khác nhau thì báo <code class="docutils literal notranslate"><span class="pre">ERROR</span></code></p></li>
<li><p>Chọn ROW cùng giá trị giữa các Key-column và ghép lại với nhau</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="p">,</span><span class="w"> </span><span class="n">VOLUME_S</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
<span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">TABLE2</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="using-clause-chi-dinh-1-or-1-vai-columns-cung-ten-de-match">
<h2><span class="section-number">2.9.2. </span>2.2 <code class="docutils literal notranslate"><span class="pre">USING</span></code> Clause : Chỉ định 1 or 1 vài columns cùng tên để match<a class="headerlink" href="#using-clause-chi-dinh-1-or-1-vai-columns-cung-ten-de-match" title="Permalink to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">STOCK</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CLOSE_P</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">VOLUME_S</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">TABLE2</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">STOCK_ID</span><span class="p">)</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">STOCK_ID</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;AC%&#39;</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Chú ý:</strong></p>
<ul class="simple">
<li><p>Trong <code class="docutils literal notranslate"><span class="pre">USING</span></code>, <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> sử dụng tên chung chứ ko cần viết tên bảng đứng trước</p></li>
</ul>
</section>
<section id="on-clause-join-tren-1-conditions-nao-do">
<h2><span class="section-number">2.9.3. </span>2.3 <code class="docutils literal notranslate"><span class="pre">ON</span></code> Clause: JOIN TRÊN 1 CONDITIONS NÀO ĐÓ<a class="headerlink" href="#on-clause-join-tren-1-conditions-nao-do" title="Permalink to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">STOCK</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">VOLUME_S</span><span class="p">,</span><span class="k">c</span><span class="p">.</span><span class="n">volume_sp</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">TABLE2</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Join nhiều hơn 2 bảng</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">STOCK</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">VOLUME_S</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">TABLE2</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">STOCK_ID</span><span class="p">)</span><span class="w"></span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">TABLE3</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">volumn_s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">volume_sp</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="self-join-join-cac-du-lieu-trong-cung-1-bang">
<h1><span class="section-number">2.10. </span>3. Self-Join : Join các dữ liệu trong cùng 1 bảng<a class="headerlink" href="#self-join-join-cac-du-lieu-trong-cung-1-bang" title="Permalink to this heading">#</a></h1>
<p>Bảng EMPLOYEES</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>employee_id</p></th>
<th class="head"><p>Name_employee</p></th>
<th class="head"><p>manager_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>a1</p></td>
<td><p>dat</p></td>
<td><p>(null)</p></td>
</tr>
<tr class="row-odd"><td><p>d2</p></td>
<td><p>son</p></td>
<td><p>a1</p></td>
</tr>
<tr class="row-even"><td><p>d3</p></td>
<td><p>minh</p></td>
<td><p>a1</p></td>
</tr>
<tr class="row-odd"><td><p>c4</p></td>
<td><p>linh</p></td>
<td><p>d2</p></td>
</tr>
<tr class="row-even"><td><p>c5</p></td>
<td><p>TA</p></td>
<td><p>d2</p></td>
</tr>
<tr class="row-odd"><td><p>a6</p></td>
<td><p>Loan</p></td>
<td><p>d2</p></td>
</tr>
<tr class="row-even"><td><p>a7</p></td>
<td><p>XUAN</p></td>
<td><p>d2</p></td>
</tr>
<tr class="row-odd"><td><p>a8</p></td>
<td><p>DUong</p></td>
<td><p>c4</p></td>
</tr>
<tr class="row-even"><td><p>s9</p></td>
<td><p>Chang</p></td>
<td><p>c4</p></td>
</tr>
<tr class="row-odd"><td><p>d21</p></td>
<td><p>Huyen</p></td>
<td><p>a1</p></td>
</tr>
<tr class="row-even"><td><p>c32</p></td>
<td><p>Thao</p></td>
<td><p>c4</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Muốn tìm tên của manager : join manager_id với employee_id</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Name_employee</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">manager_id</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Name_employee</span><span class="w"> </span><span class="n">Name_manager</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">EMPLOYEES</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">EMPLOYEES</span><span class="w"> </span><span class="n">m</span><span class="w"> </span>
<span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">manager_id</span><span class="o">=</span><span class="n">m</span><span class="p">.</span><span class="n">employee_id</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nonequijoins">
<h1><span class="section-number">2.11. </span>4. Nonequijoins<a class="headerlink" href="#nonequijoins" title="Permalink to this heading">#</a></h1>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Rating</p></th>
<th class="head"><p>lowest_return</p></th>
<th class="head"><p>highest_return</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Excellent</p></td>
<td><p>0.1</p></td>
<td><p>999</p></td>
</tr>
<tr class="row-odd"><td><p>Good</p></td>
<td><p>0.05</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p>Normal</p></td>
<td><p>0.02</p></td>
<td><p>0.05</p></td>
</tr>
<tr class="row-odd"><td><p>Poor</p></td>
<td><p>-0.02</p></td>
<td><p>0.02</p></td>
</tr>
<tr class="row-even"><td><p>Bad</p></td>
<td><p>-999</p></td>
<td><p>-0.02</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Dựa vào bản <code class="docutils literal notranslate"><span class="pre">RAKING_RETURN</span></code> để xếp hạng <code class="docutils literal notranslate"><span class="pre">STOCK</span></code> trong bảng <code class="docutils literal notranslate"><span class="pre">ALLSTOCKTEST</span></code></p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">STOCK</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">DAY_TRADING</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">RETURN_S</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Rating</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">RAKING_RETURN</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">RETURN_S</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">lowest_return</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Highest_return</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="outer-join">
<h1><span class="section-number">2.12. </span>5. Outer Join :<a class="headerlink" href="#outer-join" title="Permalink to this heading">#</a></h1>
<p>Lấy Full 1 bên table, kể cả những row ko có data để ghép bên bảng kia</p>
<p><code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> / <code class="docutils literal notranslate"><span class="pre">RIGHT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> / <code class="docutils literal notranslate"><span class="pre">FULL</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">STOCK</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">DAY_TRADING</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">RETURN_S</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Rating</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">OUTER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">RAKING_RETURN</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">RETURN_S</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">lowest_return</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Highest_return</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cartesian-product-cross-join">
<h1><span class="section-number">2.13. </span>6. Cartesian Product : <code class="docutils literal notranslate"><span class="pre">Cross</span> <span class="pre">Join</span> </code><a class="headerlink" href="#cartesian-product-cross-join" title="Permalink to this heading">#</a></h1>
<p>Join không cần điều kiện gì, mục đích để tạo table có nhiều dòng:
<code class="docutils literal notranslate"><span class="pre">Table1(10rows)</span> <span class="pre">x</span> <span class="pre">Table2(15rows)</span> <span class="pre">=</span> <span class="pre">Table3(150rows)</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">STOCK</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">CLOSE_P</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="n">SECTOR_S</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="k">CROSS</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">TABLE2</span><span class="w"> </span><span class="n">B</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">SQLcode</span> <span class="k">as</span> <span class="nn">sql</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cx_Oracle</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cx_Oracle</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="s1">&#39;SYSTEM&#39;</span><span class="p">,</span><span class="s1">&#39;21061998&#39;</span><span class="p">,</span><span class="s1">&#39;192.168.0.100/db12c&#39;</span><span class="p">)</span>
<span class="n">curs</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Câu SQL không phân biệt chữ HOA vs thường</p></li>
<li><p>Kết thúc câu SQL bằng <code class="docutils literal notranslate"><span class="pre">;</span></code></p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="creat-table">
<h1><span class="section-number">2.14. </span>1. Creat table<a class="headerlink" href="#creat-table" title="Permalink to this heading">#</a></h1>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">TABLETEST</span><span class="w"> </span>
<span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">COL1</span><span class="w"> </span><span class="nb">NUMBER</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span>
<span class="p">,</span><span class="w"> </span><span class="n">COLUMN2</span><span class="w"> </span><span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">CREATE TABLE TABLETEST </span>
<span class="s1">(</span>
<span class="s1">  COL1 NUMBER(12) NOT NULL </span>
<span class="s1">, COLUMN2 VARCHAR2(20) </span>
<span class="s1">)</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">sql</span><span class="o">.</span><span class="n">codequery</span><span class="p">(</span><span class="n">ddl</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lệnh SQL đã được chạy thành công
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="select-table">
<h1><span class="section-number">2.15. </span>2. Select table<a class="headerlink" href="#select-table" title="Permalink to this heading">#</a></h1>
<p><strong>chọn toàn bộ table</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">TABLETEST</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p><strong>chọn 1 số columns table</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">TABLETEST</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK,DAY_TRADING FROM ALLSTOCKTEST&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>DAY_TRADING</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>2020-01-20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>2020-01-19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>2020-01-18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>2020-01-17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>2020-01-16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK,CLOSE_P,volume_s,Close_p + 4,close_p*volume_s FROM ALLSTOCKTEST&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
      <th>VOLUME_S</th>
      <th>CLOSE_P+4</th>
      <th>CLOSE_P*VOLUME_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>19</td>
      <td>1300000</td>
      <td>23</td>
      <td>24700000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>20</td>
      <td>1257000</td>
      <td>24</td>
      <td>25140000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>20</td>
      <td>1214000</td>
      <td>24</td>
      <td>24280000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>21</td>
      <td>1171000</td>
      <td>25</td>
      <td>24591000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>22</td>
      <td>1128000</td>
      <td>26</td>
      <td>24816000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Column Alias</strong> : ký hiệu tên column</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="w"> </span><span class="n">col1_alias</span><span class="p">,</span><span class="n">col2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">col2_alias</span><span class="p">,</span><span class="w"> </span><span class="n">col3</span><span class="w"> </span><span class="ss">&quot;col3 alias&quot;</span><span class="p">,</span><span class="n">col4</span><span class="w"> </span><span class="ss">&quot;Col4!#AliAS&quot;</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">TABLETEST</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>sử dụng dấu nháy kép <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> để khi cần ký hiệu có <code class="docutils literal notranslate"><span class="pre">space</span> </code>,<code class="docutils literal notranslate"><span class="pre">ký</span> <span class="pre">hiệu</span> <span class="pre">đặc</span> <span class="pre">biệt</span></code> , hoặc <code class="docutils literal notranslate"><span class="pre">phân</span> <span class="pre">biệt</span> <span class="pre">HOA</span> <span class="pre">thường</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK cp,CLOSE_P as price FROM ALLSTOCKTEST&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CP</th>
      <th>PRICE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>concat chuỗi</strong> by <code class="docutils literal notranslate"><span class="pre">||</span></code> : nối chuỗi</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK||DAY_TRADING as IDStock FROM ALLSTOCKTEST&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDSTOCK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB20-JAN-20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB19-JAN-20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB18-JAN-20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB17-JAN-20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB16-JAN-20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>nối giá trị với ‘literal string’</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;giá của &#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39; vào ngày&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">DAY_TRADING</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39; là &#39;</span><span class="o">||</span><span class="n">close_p</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">StatusStock</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
</pre></div>
</div>
<p>or use q’[string has ‘ comma]’</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT &#39;The &#39; || STOCK || q&#39;[&#39;s close price on ]&#39; || DAY_TRADING || &#39; is &#39;||close_p as StatusStock FROM ALLSTOCKTEST
</pre></div>
</div>
<p>or use 2 single quote <code class="docutils literal notranslate"><span class="pre">''</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;The &#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;s close price on &#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">DAY_TRADING</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39; is &#39;</span><span class="o">||</span><span class="n">close_p</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">StatusStock</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
</pre></div>
</div>
<section id="seclect-distinct-select-loai-bo-trung-lap">
<h2><span class="section-number">2.15.1. </span>2.1 SECLECT DISTINCT : select loại bỏ trùng lặp<a class="headerlink" href="#seclect-distinct-select-loai-bo-trung-lap" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK FROM ALLSTOCKTEST&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ACC</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ACC</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ACC</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Select + loại bỏ giá trị trùng lặp</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># loại bỏ trùng lặp</span>
<span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT distinct STOCK FROM ALLSTOCKTEST&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AVM</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>DESCRISE</strong> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DESC</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="select-where-filter-rows">
<h2><span class="section-number">2.15.2. </span>2.2 Select + where : filter rows<a class="headerlink" href="#select-where-filter-rows" title="Permalink to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">tabletest</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="w"></span>
</pre></div>
</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Toán tử</p></th>
<th class="head"><p>Miêu tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>=</p></td>
<td><p>bằng</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;=</p></td>
<td><p>lớn hơn hoặc bằng</p></td>
</tr>
<tr class="row-even"><td><p>&lt;=</p></td>
<td><p>bé hơn hoặc bằng</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;</p></td>
<td><p>lớn hơn</p></td>
</tr>
<tr class="row-even"><td><p>&lt;</p></td>
<td><p>bé hơn</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;&gt;</p></td>
<td><p>khác</p></td>
</tr>
<tr class="row-even"><td><p>BETWEEN a AND b</p></td>
<td><p>Giá trị nằm trong khoảng a &lt;= x &lt;= b</p></td>
</tr>
<tr class="row-odd"><td><p>IN {SET}</p></td>
<td><p>lấy x trong tập set</p></td>
</tr>
<tr class="row-even"><td><p>LIKE ‘a%’</p></td>
<td><p>lấy giá trị gần giống a: a123,abc,ax,…</p></td>
</tr>
<tr class="row-odd"><td><p>LIKE ‘a_’</p></td>
<td><p>lấy giá trị gần giống a: a1,ab,ax,…</p></td>
</tr>
<tr class="row-even"><td><p>IS NULL</p></td>
<td><p>so sánh giá trị null</p></td>
</tr>
<tr class="row-odd"><td><p>AND</p></td>
<td><p>và</p></td>
</tr>
<tr class="row-even"><td><p>OR</p></td>
<td><p>hoặc</p></td>
</tr>
<tr class="row-odd"><td><p>NOT</p></td>
<td><p>ngược lại</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST WHERE Close_p BETWEEN 17 AND 27&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AVM</td>
      <td>22.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AVM</td>
      <td>23.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AVM</td>
      <td>24.44</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AVM</td>
      <td>23.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AVM</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AVM</td>
      <td>26.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;%&#39; là 0 hoặc nhiều characters</span>
<span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST WHERE STOCK like </span><span class="se">\&#39;</span><span class="s1">AC%</span><span class="se">\&#39;</span><span class="s1">&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>12.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>12.23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>12.44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>12.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>14.89</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB</td>
      <td>14.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ACC</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ACC</td>
      <td>29.00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ACC</td>
      <td>30.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># gạch dưới &#39;_&#39; là 1 character</span>
<span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST WHERE STOCK like </span><span class="se">\&#39;</span><span class="s1">A_C%</span><span class="se">\&#39;</span><span class="s1">&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACC</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACC</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACC</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sử dụng <code class="docutils literal notranslate"><span class="pre">escape</span></code> nếu muốn where-like pattern chứa ký tự thường là ‘%’ hoặc ‘_’</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">tabletest</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">last_name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;Khong\_Tien%&#39;</span><span class="w"> </span><span class="k">ESCAPE</span><span class="w"> </span><span class="s1">&#39;\&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>khi đó filter last_name = ‘Khong_Tien…’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST WHERE DAY_TRADING=</span><span class="se">\&#39;</span><span class="s1">18-JAN-20</span><span class="se">\&#39;</span><span class="s1">&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>12.44</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AVM</td>
      <td>24.44</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACC</td>
      <td>30.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST WHERE STOCK in (</span><span class="se">\&#39;</span><span class="s1">ACB</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1">AVM</span><span class="se">\&#39;</span><span class="s1">)&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>12.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>12.23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>12.44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>12.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>14.89</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB</td>
      <td>14.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AVM</td>
      <td>22.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AVM</td>
      <td>23.40</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AVM</td>
      <td>24.44</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM</td>
      <td>23.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM</td>
      <td>26.00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM</td>
      <td>27.67</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST WHERE STOCK in (</span><span class="se">\&#39;</span><span class="s1">ACB</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1">AVM</span><span class="se">\&#39;</span><span class="s1">) AND close_p between 15 and 23&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AVM</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AVM</td>
      <td>23.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="select-order-by-sorted">
<h2><span class="section-number">2.15.3. </span>2.3 Select + ORDER BY : sorted<a class="headerlink" href="#select-order-by-sorted" title="Permalink to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">tabletest</span><span class="w"></span>
<span class="p">[</span><span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Col1</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="p">],</span><span class="n">col2</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="p">],..]</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>nếu không <code class="docutils literal notranslate"><span class="pre">DESC</span></code> thì mặc định là <code class="docutils literal notranslate"><span class="pre">ASC</span></code></p></li>
<li><p>Có thể dùng column alias (ký hiệu) trong ORDER BY</p></li>
<li><p>Có thể dùng thứ tự column 1,2,3,..</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NULL</span></code> sẽ đóng vai trò là giá trị lớn nhất, nếu <code class="docutils literal notranslate"><span class="pre">DESC</span></code> thì <code class="docutils literal notranslate"><span class="pre">null</span></code> nằm đầu tiên</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P FROM ALLSTOCKTEST ORDER BY STOCK DESC, CLOSE_P&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AVM</td>
      <td>22.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AVM</td>
      <td>23.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AVM</td>
      <td>23.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AVM</td>
      <td>24.44</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AVM</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AVM</td>
      <td>26.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AVM</td>
      <td>27.67</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ACC</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ACC</td>
      <td>29.00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ACC</td>
      <td>30.00</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ACB</td>
      <td>12.20</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ACB</td>
      <td>12.23</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ACB</td>
      <td>12.44</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ACB</td>
      <td>12.50</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ACB</td>
      <td>14.00</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ACB</td>
      <td>14.89</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ACB</td>
      <td>17.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sử dụng column alias</span>
<span class="c1"># 1 tương ứng với column 1 : là column STOCK</span>
<span class="n">ddl2</span><span class="o">=</span><span class="s1">&#39;SELECT STOCK, CLOSE_P GIA,Volume_s FROM ALLSTOCKTEST ORDER BY 3 DESC, GIA&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>GIA</th>
      <th>VOLUME_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>12.20</td>
      <td>1300000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>12.23</td>
      <td>1257000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>12.44</td>
      <td>1214000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>12.50</td>
      <td>1171000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>14.89</td>
      <td>1128000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB</td>
      <td>17.00</td>
      <td>1085000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB</td>
      <td>14.00</td>
      <td>1042000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AVM</td>
      <td>22.00</td>
      <td>999000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AVM</td>
      <td>23.40</td>
      <td>956000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AVM</td>
      <td>24.44</td>
      <td>913000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM</td>
      <td>23.00</td>
      <td>870000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM</td>
      <td>25.00</td>
      <td>827000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM</td>
      <td>26.00</td>
      <td>784000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM</td>
      <td>27.67</td>
      <td>741000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ACC</td>
      <td>28.00</td>
      <td>698000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ACC</td>
      <td>29.00</td>
      <td>655000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ACC</td>
      <td>30.00</td>
      <td>612000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="select-group-by-grouping">
<h2><span class="section-number">2.15.4. </span>2.4 Select + GROUP BY : grouping<a class="headerlink" href="#select-group-by-grouping" title="Permalink to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">tabletest</span><span class="w"></span>
<span class="p">[</span><span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">expression</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Col1</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="p">],</span><span class="n">col2</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="p">],..]</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;SELECT STOCK,AVG(CLOSE_P)</span>
<span class="s2">FROM ALLSTOCKTEST</span>
<span class="s2">GROUP BY STOCK</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>AVG(CLOSE_P)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACC</td>
      <td>29.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>13.608571</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AVM</td>
      <td>24.501429</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#group_by nhỏ hơn</span>
<span class="n">ddl2</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;SELECT STOCK,AVG(CLOSE_P)</span>
<span class="s2">FROM ALLSTOCKTEST</span>
<span class="s2">GROUP BY STOCK,DAY_TRADING</span>
<span class="s2">ORDER BY STOCK</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>AVG(CLOSE_P)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>14.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>14.89</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>12.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>12.44</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB</td>
      <td>12.23</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB</td>
      <td>12.20</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ACC</td>
      <td>30.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ACC</td>
      <td>29.00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ACC</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM</td>
      <td>27.67</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM</td>
      <td>26.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM</td>
      <td>23.00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>AVM</td>
      <td>24.44</td>
    </tr>
    <tr>
      <th>15</th>
      <td>AVM</td>
      <td>23.40</td>
    </tr>
    <tr>
      <th>16</th>
      <td>AVM</td>
      <td>22.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="select-group-by-having-tao-bo-loc-sau-khi-da-chay-group-by">
<h2><span class="section-number">2.15.5. </span>2.3 Select + GROUP BY + HAVING : tạo bộ lọc sau khi đã chạy GROUP BY<a class="headerlink" href="#select-group-by-having-tao-bo-loc-sau-khi-da-chay-group-by" title="Permalink to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">tabletest</span><span class="w"></span>
<span class="p">[</span><span class="k">WHERE</span><span class="w"> </span><span class="n">conditions</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">expression</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="k">HAVING</span><span class="w"> </span><span class="n">conditions</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Col1</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="p">],</span><span class="n">col2</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="p">],..]</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Having</span></code> giúp tạo bộ lọc sau khi đã chạy <code class="docutils literal notranslate"><span class="pre">group</span> <span class="pre">by</span></code> còn <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> tạo bộ lọc trước khi chạy <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code></p></li>
<li><p>Sử dụng được multiple-function trong <code class="docutils literal notranslate"><span class="pre">Having</span></code> chứ ko sử dụng được trong <code class="docutils literal notranslate"><span class="pre">WHERE</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;SELECT STOCK,MAX(CLOSE_P)</span>
<span class="s2">FROM ALLSTOCKTEST</span>
<span class="s2">GROUP BY STOCK</span>
<span class="s2">HAVING MAX(CLOSE_P)&gt;20</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>MAX(CLOSE_P)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACC</td>
      <td>30.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AVM</td>
      <td>27.67</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddl2</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT STOCK,MAX(CLOSE_P),MAX(VOLUME_S)</span>
<span class="s2">FROM ALLSTOCKTEST</span>
<span class="s2">WHERE STOCK NOT LIKE &#39;AV_&#39;</span>
<span class="s2">GROUP BY STOCK</span>
<span class="s2">HAVING MAX(CLOSE_P)&gt;20</span>
<span class="s2">ORDER BY MAX(CLOSE_P)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">ddl2</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>MAX(CLOSE_P)</th>
      <th>MAX(VOLUME_S)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACC</td>
      <td>30</td>
      <td>698000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="subquery">
<h1><span class="section-number">2.16. </span>3. SUBQUERY<a class="headerlink" href="#subquery" title="Permalink to this heading">#</a></h1>
<div class="highlight-SQL notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">CLOSE_P</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">CLOSE_P</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ACB&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Single-row Subquery</strong> : câu subquery return ra 1 row
khi đó ta sử dụng các toán tử so sánh 1 row</p>
<p><strong>Multi-row Subquery</strong> : câu subquery return ra nhiều rows, khi đó ta sử dụng:</p>
<ul class="simple">
<li><p>các multi-row function để trả về 1 row</p></li>
<li><p>hoặc sử dụng <code class="docutils literal notranslate"><span class="pre">IN</span></code>, <code class="docutils literal notranslate"><span class="pre">ANY</span></code>, <code class="docutils literal notranslate"><span class="pre">ALL</span></code></p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">CLOSE_P</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">ALL</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ACB&#39;</span><span class="p">)</span><span class="w"></span>
<span class="k">AND</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="set-operator-ghep-bang-them-row-theo-cot">
<h1><span class="section-number">2.17. </span>4. SET OPERATOR (ghép bảng = thêm row theo cột)<a class="headerlink" href="#set-operator-ghep-bang-them-row-theo-cot" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">UNION</span></code> : LẤY PHẦN TỬ IN A HOẶC B</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UNION</span> <span class="pre">ALL</span></code> : LẤY PHẦN TỬ IN A + PHẦN TỬ IN B (ko quan tâm tới duplicate)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INTERSECT</span></code> : LẤY PHẦN TỬ IN A VÀ B</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MINUS</span></code> : LẤY PHẦN TỬ IN A TRỪ IN B</p></li>
</ul>
<p><strong>chú ý</strong></p>
<ul class="simple">
<li><p>Số lượng column ở 2 câu query phải như nhau, data-type từng column tương ứng phải giống nhau</p></li>
<li><p>Tên column sẽ lấy tên column ở câu query thứ 1</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">CLOSE_P</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
<span class="k">UNION</span><span class="w"></span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">CLOSE_P</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKS</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">STOCK</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">RETURN_P</span><span class="p">,</span><span class="w"> </span><span class="n">TO_CHAR</span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="n">NOTE</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"></span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">TO_Number</span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="n">NOTE_STOCK</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKS</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>cột return_p(number) ở query1 nên phải <code class="docutils literal notranslate"><span class="pre">to_number</span></code> cột thứ 2 ở câu query 2</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cx_Oracle</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cx_Oracle</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="s1">&#39;SYSTEM/21061998@localhost/db12c&#39;</span><span class="p">)</span>
<span class="n">curs</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>1. Chạy code sql mà ko cần dùng pandas để hiển thị</strong></p>
<p>Chú ý trong code query ở oracle database có kết thúc bằng <code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">;</span></code> , khi đưa vào python cần loại bỏ đi</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">codequery</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="c1"># viết sql code</span>
        <span class="n">c</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># thực hiện chạy sql code</span>
        <span class="n">result</span><span class="o">=</span><span class="s1">&#39;Lệnh SQL đã được chạy thành công&#39;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">result</span><span class="o">=</span><span class="s1">&#39;Lệnh SQL chạy đã bị lỗi&#39;</span>
    <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<p><strong>2. chạy code sql kết hợp pandas dataframe để hiển thị</strong></p>
<p><code class="docutils literal notranslate"> <span class="pre">pd.read_sql_query(ddl,conn)</span></code></p>
<p>chú ý: <code class="docutils literal notranslate"><span class="pre">ddl</span></code> phải loại bỏ dấu <code class="docutils literal notranslate"><span class="pre">;</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">/</span></code> ở cuối lệnh</p>
<p><strong>3. Chạy ‘file.sql’</strong></p>
<p><strong>Approach1</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pathsql</span><span class="o">=</span><span class="s1">&#39;./pathfile.sql&#39;</span>
<span class="n">query</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">pathfile</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># remove ended &#39;;&#39; in script SQL</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./query_file.sql&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> 

<span class="n">db_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;server&#39;</span><span class="p">:</span> <span class="n">server</span> <span class="n">address</span><span class="p">,</span>
            <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
            <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
            <span class="s1">&#39;database&#39;</span><span class="p">:</span> <span class="n">db</span> <span class="n">name</span>
        <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">sql_conn</span> <span class="o">=</span> <span class="n">cx_Oracle</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="o">**</span><span class="n">db_config</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;SQL connection is opened&#39;</span><span class="p">)</span>       
        <span class="n">avise_me_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">sql_conn</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;pandas df recorded&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">OperationalError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error reading data from SQL table&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
            <span class="n">sql_conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;SQL connection is closed&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Approach 2</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path2</span><span class="o">=</span><span class="s1">&#39;C:/Users/PC/Desktop/DAT.sql&#39;</span>
<span class="n">m</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">path2</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">read</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STOCK</th>
      <th>DAY_TRADING</th>
      <th>CLOSE_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACB</td>
      <td>2020-01-20</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACB</td>
      <td>2020-01-19</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACB</td>
      <td>2020-01-18</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACB</td>
      <td>2020-01-17</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACB</td>
      <td>2020-01-16</td>
      <td>22</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACB</td>
      <td>2020-01-15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACB</td>
      <td>2020-01-14</td>
      <td>24</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AVM</td>
      <td>2020-01-13</td>
      <td>25</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AVM</td>
      <td>2020-01-12</td>
      <td>26</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AVM</td>
      <td>2020-01-11</td>
      <td>27</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AVM</td>
      <td>2020-01-10</td>
      <td>28</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AVM</td>
      <td>2020-01-09</td>
      <td>29</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AVM</td>
      <td>2020-01-08</td>
      <td>30</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AVM</td>
      <td>2020-01-07</td>
      <td>31</td>
    </tr>
    <tr>
      <th>14</th>
      <td>AVM</td>
      <td>2020-01-06</td>
      <td>32</td>
    </tr>
    <tr>
      <th>15</th>
      <td>AVM</td>
      <td>2020-01-05</td>
      <td>33</td>
    </tr>
    <tr>
      <th>16</th>
      <td>AVM</td>
      <td>2020-01-04</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id2">
<h1><span class="section-number">2.18. </span>1. Creat table<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h1>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">TABLETEST</span><span class="w"> </span>
<span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">COL1</span><span class="w"> </span><span class="nb">NUMBER</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span>
<span class="p">,</span><span class="w"> </span><span class="n">COLUMN2</span><span class="w"> </span><span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span>
<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># creat table</span>
<span class="n">ddl</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">CREATE TABLE TABLETEST </span>
<span class="s2">(</span>
<span class="s2">  COL1 NUMBER(12) NOT NULL </span>
<span class="s2">, COLUMN2 VARCHAR2(20) </span>
<span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">codequery</span><span class="p">(</span><span class="n">ddl</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lệnh SQL đã được chạy thành công
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id3">
<h1><span class="section-number">2.19. </span>2. Select table<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cx_Oracle</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cx_Oracle</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="s1">&#39;SYSTEM/21061998@192.168.0.100/db12c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">DatabaseError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">599</span><span class="n">b5e524f52</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">cx_Oracle</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">cx_Oracle</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="s1">&#39;SYSTEM/21061998@192.168.0.100/db12c&#39;</span><span class="p">)</span>

<span class="ne">DatabaseError</span>: Error while trying to retrieve text for error ORA-01804
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">connect</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">conn</span><span class="o">=</span><span class="n">connect</span><span class="o">.</span><span class="n">connection</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="single-row-function">
<h1><span class="section-number">2.20. </span>1. Single-row Function<a class="headerlink" href="#single-row-function" title="Permalink to this heading">#</a></h1>
<section id="character-functions">
<h2><span class="section-number">2.20.1. </span>1.1 Character Functions<a class="headerlink" href="#character-functions" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>LOWER</strong>(str)</p></td>
<td><p>viết thường str</p></td>
</tr>
<tr class="row-odd"><td><p><strong>UPPER</strong>(str)</p></td>
<td><p>VIẾT HOA STR</p></td>
</tr>
<tr class="row-even"><td><p><strong>INITCAP</strong>(str)</p></td>
<td><p>Viết Hoa Chữ Đầu</p></td>
</tr>
<tr class="row-odd"><td><p><strong>CONCAT</strong>(str1,str2,…)</p></td>
<td><p>Nối str</p></td>
</tr>
<tr class="row-even"><td><p><strong>SUBSTR</strong>(str, start, length)</p></td>
<td><p>trích từ str với đánh dấu từ 1,2,3,… hoặc …-3,-2,-1</p></td>
</tr>
<tr class="row-odd"><td><p><strong>LENGTH</strong>(str)</p></td>
<td><p>Độ dài str</p></td>
</tr>
<tr class="row-even"><td><p><strong>INSTR</strong>(str, substr, a, b)</p></td>
<td><p>Trả vị trí của ký tự substr lần thứ b[1] trong str bắt đầu từ vị trí a[1]</p></td>
</tr>
<tr class="row-odd"><td><p><strong>LPAD/RPAD</strong>(str,full-length,’x’)</p></td>
<td><p>lấp đầy bên L/R của str thành full-length bởi ký tự ‘x’</p></td>
</tr>
<tr class="row-even"><td><p><strong>TRIM</strong>(‘x’ <strong>FROM</strong> str</p></td>
<td><p>xóa toàn bộ ‘x’ hai bên của str</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TRIM</strong>( [LEADING/TRAILING]  ‘x’  <strong>FROM</strong> str</p></td>
<td><p>xóa toàn bộ ‘x’ bên trái(LEADING) hoặc bên phải(TRAILING) của str</p></td>
</tr>
<tr class="row-even"><td><p><strong>REPLACE</strong>(str,’x’,’y’)</p></td>
<td><p>thay thế ‘x’ bằng ‘y’ trong str</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT instr(&#39;dssais ka m ais&#39;,&#39;is&#39;) </span>
<span class="s1">test</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TEST</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT substr(</span><span class="se">\&#39;</span><span class="s1">dssaims ka m ais</span><span class="se">\&#39;</span><span class="s1">,-3,3) </span>
<span class="s1">test</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TEST</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ais</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT concat(&#39;AB&#39;,&#39;t&#39;) </span>
<span class="s1">test</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TEST</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ABt</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="number-functions">
<h2><span class="section-number">2.20.2. </span>1.2 Number Functions<a class="headerlink" href="#number-functions" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>ROUND</strong>(num,a)</p></td>
<td><p>làm tròn num ở vị trí a sau dấu thập phân</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TRUNC</strong>(num,a)</p></td>
<td><p>cắt num ở vị trí a sau dấu thập phân</p></td>
</tr>
<tr class="row-even"><td><p><strong>MOD</strong>(num,a)</p></td>
<td><p>số dư của num chia cho a</p></td>
</tr>
<tr class="row-odd"><td><p><strong>ABS</strong></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>FLOOR</strong></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>CEIL</strong></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT ROUND(123.456,2) test1, ROUND(123.456,-1) test2, TRUNC(123.456,-2) test3, MOD(123456,1000) test4</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TEST1</th>
      <th>TEST2</th>
      <th>TEST3</th>
      <th>TEST4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>123.46</td>
      <td>120</td>
      <td>100</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="date-functions">
<h2><span class="section-number">2.20.3. </span>1.3 Date Functions<a class="headerlink" href="#date-functions" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># trả về thời điểm hiện tại</span>
<span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT SYSDATE,SYSDATE + 1, SYSDATE + 1/24</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SYSDATE</th>
      <th>SYSDATE+1</th>
      <th>SYSDATE+1/24</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-02-02 15:59:06</td>
      <td>2020-02-03 15:59:06</td>
      <td>2020-02-02 16:59:06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>MONTHS_BETWEEN</strong>(date1,date2)</p></td>
<td><p>Tính số tháng giữa date1 vs date2</p></td>
</tr>
<tr class="row-odd"><td><p><strong>ADD_MONTHS</strong>(date1,num_mon)</p></td>
<td><p>cộng thêm num_mon tháng vào date1</p></td>
</tr>
<tr class="row-even"><td><p><strong>NEXT_DAY</strong>(date,weekday)</p></td>
<td><p>trả về ngày tiếp theo là weekday từ ngày date</p></td>
</tr>
<tr class="row-odd"><td><p><strong>LAST_DAY</strong>(date)</p></td>
<td><p>trả ngày cuối cùng của tháng date</p></td>
</tr>
<tr class="row-even"><td><p><strong>ROUND</strong>(date, ‘month/year’)</p></td>
<td><p>làm tròn date theo tháng hoặc năm</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TRUNC</strong>(date, ‘month/year’)</p></td>
<td><p>cắt date theo tháng hoặc năm</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT SYSDATE,MONTHS_BETWEEN(SYSDATE,&#39;01-JAN-20&#39;), ADD_MONTHS(&#39;31-JAN-96&#39;,1), NEXT_DAY(SYSDATE,&#39;FRIDAY&#39;), LAST_DAY(SYSDATE)</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SYSDATE</th>
      <th>MONTHS_BETWEEN(SYSDATE,'01-JAN-20')</th>
      <th>ADD_MONTHS('31-JAN-96',1)</th>
      <th>NEXT_DAY(SYSDATE,'FRIDAY')</th>
      <th>LAST_DAY(SYSDATE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-02-02 16:18:30</td>
      <td>1.054178</td>
      <td>1996-02-29</td>
      <td>2020-02-07 16:18:30</td>
      <td>2020-02-29 16:18:30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ngày từ 1-15 làm tròn xuống, tháng từ 1-6 làm tròn xuống</span>
<span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT SYSDATE,ROUND(SYSDATE,&#39;month&#39;), ROUND(SYSDATE,&#39;year&#39;), TRUNC(SYSDATE,&#39;month&#39;), TRUNC(SYSDATE,&#39;year&#39;)</span>
<span class="s1">FROM dual</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SYSDATE</th>
      <th>ROUND(SYSDATE,'MONTH')</th>
      <th>ROUND(SYSDATE,'YEAR')</th>
      <th>TRUNC(SYSDATE,'MONTH')</th>
      <th>TRUNC(SYSDATE,'YEAR')</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-02-02 16:45:56</td>
      <td>2020-02-01</td>
      <td>2020-01-01</td>
      <td>2020-02-01</td>
      <td>2020-01-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="conversion-functions">
<h2><span class="section-number">2.20.4. </span>1.4 Conversion Functions<a class="headerlink" href="#conversion-functions" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>TO_DATE</strong>(char,’format’)</p></td>
<td><p>Convert char thành DATE với khai báo char đang follow theo format cho trước</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TO_NUMBER</strong></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>TO_CHAR</strong>(CHARACTER)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>TO_CHAR</strong>(NUMBER,format)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>TO_CHAR</strong>(date,’format-date’)</p></td>
<td><p>convert date thành character với date theo format mong muốn</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>implicit data type conversion : oracle tự động converse được sang kiểu phù hợp. ví dụ: ‘123’+3 thì oracle converse được ‘123’ thành kiểu number 123</p></li>
<li><p>explicit data type conversion : ta phải tự viết hàm converse data, data không ở dạng mà oracle có thể tự động converse được.</p></li>
</ul>
<p><strong>ký hiệu cho date</strong></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>YYYY</strong></p></td>
<td><p>hiển thị năm 2017</p></td>
</tr>
<tr class="row-odd"><td><p><strong>YEAR</strong></p></td>
<td><p>Hiển thị năm viết chữ</p></td>
</tr>
<tr class="row-even"><td><p><strong>MONTH</strong></p></td>
<td><p>Hiển thị tháng January</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MON</strong></p></td>
<td><p>Hiển thị tháng JAN</p></td>
</tr>
<tr class="row-even"><td><p><strong>MM</strong></p></td>
<td><p>Hiển thị tháng 01</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DY</strong></p></td>
<td><p>Hiển thị ngày trong tuần FRI</p></td>
</tr>
<tr class="row-even"><td><p><strong>DAY</strong></p></td>
<td><p>Hiển thị ngày trong tuần full-name MONDAY</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DD</strong></p></td>
<td><p>Hiển thị ngày trong tháng 01,02,…</p></td>
</tr>
<tr class="row-even"><td><p><strong>HH24:MI:SS AM</strong></p></td>
<td><p>14:05:34 PM</p></td>
</tr>
<tr class="row-odd"><td><p><strong>‘DD “of” MONTH’</strong></p></td>
<td><p>12 of JUNE</p></td>
</tr>
<tr class="row-even"><td><p><strong>DDspth</strong></p></td>
<td><p>ngày 14 là ‘fourteenth’, ‘sp’ ký hiệu của spelling</p></td>
</tr>
</tbody>
</table>
<section id="to-char-thuong-dung-cho-out-put-data">
<h3><span class="section-number">2.20.4.1. </span><code class="docutils literal notranslate"><span class="pre">To_CHAR</span></code> thường dùng cho out-put data<a class="headerlink" href="#to-char-thuong-dung-cho-out-put-data" title="Permalink to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">TO_CHAR</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span><span class="s1">&#39;hh24:mi:ss DD/Month/YYYY&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">DAYY</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">dual</span><span class="w"></span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">TO_CHAR</span><span class="p">(</span><span class="n">CLOSE_P</span><span class="p">,</span><span class="s1">&#39;$99,999.00&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">GIA</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">dual</span><span class="w"></span>
</pre></div>
</div>
<p>#đưa giá về dạng format, <code class="docutils literal notranslate"><span class="pre">9</span></code> đại diện cho số, <code class="docutils literal notranslate"><span class="pre">0</span></code> đại diện cho không phải số nhưng ép số, <code class="docutils literal notranslate"><span class="pre">$</span></code>/<code class="docutils literal notranslate"><span class="pre">L</span></code> đại diện cho tiền tệ</p>
</section>
<section id="to-num-or-to-date-thuong-dung-cho-in-put-data">
<h3><span class="section-number">2.20.4.2. </span><code class="docutils literal notranslate"><span class="pre">To_NUM</span></code> or <code class="docutils literal notranslate"><span class="pre">TO_DATE</span></code> thường dùng cho in-put data<a class="headerlink" href="#to-num-or-to-date-thuong-dung-cho-in-put-data" title="Permalink to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="n">CLOSE_P</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">GIA</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">DAY_TRADING</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TO_DATE</span><span class="p">(</span><span class="s1">&#39;21/06/18&#39;</span><span class="p">,</span><span class="s1">&#39;DD/MM/RR&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">'DD/MM/RR'</span></code> giúp format <code class="docutils literal notranslate"><span class="pre">'21/06/18'</span></code> cho oracle hiểu được</p>
</section>
</section>
<section id="netting-functions">
<h2><span class="section-number">2.20.5. </span>1.5 Netting Functions<a class="headerlink" href="#netting-functions" title="Permalink to this heading">#</a></h2>
</section>
<section id="general-functions">
<h2><span class="section-number">2.20.6. </span>1.6 General Functions<a class="headerlink" href="#general-functions" title="Permalink to this heading">#</a></h2>
<p>chủ yếu là hàm xử lý <code class="docutils literal notranslate"><span class="pre">null</span></code>
input parameter có thể là char, num , date, tuy nhiên các kiểu giữ liệu trong cùng 1 hàm phải giống nhau</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>NVL</strong>(a,c)</p></td>
<td><p>=a nếu a <code class="docutils literal notranslate"><span class="pre">notnull</span></code> else =c nếu a=<code class="docutils literal notranslate"><span class="pre">null</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>NVL2</strong>(a,b,c)</p></td>
<td><p>=b nếu a <code class="docutils literal notranslate"><span class="pre">notnull</span></code> else =c nếu a=<code class="docutils literal notranslate"><span class="pre">null</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>NULLIF</strong>(a,b)</p></td>
<td><p>=<code class="docutils literal notranslate"><span class="pre">null</span></code> if a=b else =a</p></td>
</tr>
<tr class="row-odd"><td><p><strong>COALESCE</strong>(a1,a2,…,an)</p></td>
<td><p>trả về giá trị đầu tiên <code class="docutils literal notranslate"><span class="pre">notnull</span></code> trong chuỗi từ a1,a2,… else trả <code class="docutils literal notranslate"><span class="pre">null</span></code></p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">TO_char</span><span class="p">(</span><span class="n">close_p</span><span class="p">),</span><span class="n">to_char</span><span class="p">(</span><span class="n">stock</span><span class="p">),</span><span class="s1">&#39;stock ko có data&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">checkdata</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">TO_char</span><span class="p">(</span><span class="n">close_p</span><span class="p">),</span><span class="n">to_char</span><span class="p">(</span><span class="n">stock</span><span class="p">),</span><span class="s1">&#39;stock ko có data&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">checkdata</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="conditional-expressions">
<h2><span class="section-number">2.20.7. </span>1.7 Conditional expressions<a class="headerlink" href="#conditional-expressions" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>CASE</strong> a WHEN b THEN c ELSE d END</p></td>
<td><p>so sánh nếu <code class="docutils literal notranslate"><span class="pre">a=b</span></code> thì return <code class="docutils literal notranslate"><span class="pre">c</span></code> , nếu ko thì return <code class="docutils literal notranslate"><span class="pre">d</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>DECODE</strong>(a,b1,c1,b2,c2,d)</p></td>
<td><p>nếu <code class="docutils literal notranslate"><span class="pre">a=b1</span></code> return <code class="docutils literal notranslate"><span class="pre">c1</span></code> else nếu <code class="docutils literal notranslate"><span class="pre">a=b2</span></code> return <code class="docutils literal notranslate"><span class="pre">c2</span></code> else <code class="docutils literal notranslate"><span class="pre">d</span></code></p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="p">,</span><span class="w"></span>
<span class="k">CASE</span><span class="w"> </span><span class="n">STOCK</span><span class="w"> </span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="n">tb</span><span class="p">.</span><span class="n">stock</span><span class="o">=</span><span class="s1">&#39;ACB&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="n">tb</span><span class="p">.</span><span class="n">stock</span><span class="o">&gt;</span><span class="s1">&#39;ACC&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;AVM&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="w"></span>
<span class="w">    </span><span class="k">ELSE</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="w"> </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NEW_P</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"> </span><span class="n">tb</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STOCK</span><span class="p">,</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="p">,</span><span class="w"></span>
<span class="n">DECODE</span><span class="p">(</span><span class="n">STOCK</span><span class="p">,</span><span class="s1">&#39;ACB&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s1">&#39;ACC&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s1">&#39;AVM&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">CLOSE_P</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">CLOSE_P</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NEW_P</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ALLSTOCKTEST</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="multiple-rows-aggregate-function">
<h1><span class="section-number">2.21. </span>2. Multiple-rows/Aggregate Function<a class="headerlink" href="#multiple-rows-aggregate-function" title="Permalink to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">AVG</span></code>,<code class="docutils literal notranslate"><span class="pre">MIN</span></code>,<code class="docutils literal notranslate"><span class="pre">MAX</span></code>,<code class="docutils literal notranslate"><span class="pre">COUNT</span></code>,<code class="docutils literal notranslate"><span class="pre">SUM</span></code>,<code class="docutils literal notranslate"><span class="pre">STDDEV</span></code>,<code class="docutils literal notranslate"><span class="pre">MEDIAN</span></code>,<code class="docutils literal notranslate"><span class="pre">VARIANCE</span></code>,…</p>
<div class="highlight-SQL notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<ul class="simple">
<li><p>CÁC HÀM BỎ QUA <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(*)</span></code> đếm cả giá trị <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(col)</span></code> ko đếm giá trị <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT AVG(CLOSE_P)</span>
<span class="s1">FROM ALLSTOCKTEST</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AVG(CLOSE_P)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20.81</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./4_SQL_noSQL"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="0_toc.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>SQL/noSQL</p>
      </div>
    </a>
    <a class="right-next"
       href="2_noSQL.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.22. </span>noSQL</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">2.1. SQL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cau-lenh-dcl">2.2. Câu lệnh DCL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cau-lenh-ddl">2.3. Câu lệnh DDL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#insert-them-du-lieu-vao-trong-table">2.4. <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> : THÊM DỮ LIỆU VÀO TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#update-sua-row-trong-table">2.5. <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> : SỬA ROW TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-xoa-row-trong-table">2.6. <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> : XÓA ROW TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#truncate-xoa-toan-bo-data-trong-table">2.7. <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>: XÓA TOÀN BỘ DATA TRONG TABLE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#type-of-join">2.8. 1. Type of Join</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#natural-join">2.9. 2. Natural Join</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.9.1. 2.1 <code class="docutils literal notranslate"><span class="pre">Natural</span> <span class="pre">Join</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-clause-chi-dinh-1-or-1-vai-columns-cung-ten-de-match">2.9.2. 2.2 <code class="docutils literal notranslate"><span class="pre">USING</span></code> Clause : Chỉ định 1 or 1 vài columns cùng tên để match</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#on-clause-join-tren-1-conditions-nao-do">2.9.3. 2.3 <code class="docutils literal notranslate"><span class="pre">ON</span></code> Clause: JOIN TRÊN 1 CONDITIONS NÀO ĐÓ</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#self-join-join-cac-du-lieu-trong-cung-1-bang">2.10. 3. Self-Join : Join các dữ liệu trong cùng 1 bảng</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nonequijoins">2.11. 4. Nonequijoins</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-join">2.12. 5. Outer Join :</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cartesian-product-cross-join">2.13. 6. Cartesian Product : <code class="docutils literal notranslate"><span class="pre">Cross</span> <span class="pre">Join</span> </code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creat-table">2.14. 1. Creat table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-table">2.15. 2. Select table</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seclect-distinct-select-loai-bo-trung-lap">2.15.1. 2.1 SECLECT DISTINCT : select loại bỏ trùng lặp</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-where-filter-rows">2.15.2. 2.2 Select + where : filter rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-order-by-sorted">2.15.3. 2.3 Select + ORDER BY : sorted</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-group-by-grouping">2.15.4. 2.4 Select + GROUP BY : grouping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-group-by-having-tao-bo-loc-sau-khi-da-chay-group-by">2.15.5. 2.3 Select + GROUP BY + HAVING : tạo bộ lọc sau khi đã chạy GROUP BY</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#subquery">2.16. 3. SUBQUERY</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#set-operator-ghep-bang-them-row-theo-cot">2.17. 4. SET OPERATOR (ghép bảng = thêm row theo cột)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.18. 1. Creat table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.19. 2. Select table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#single-row-function">2.20. 1. Single-row Function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#character-functions">2.20.1. 1.1 Character Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-functions">2.20.2. 1.2 Number Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#date-functions">2.20.3. 1.3 Date Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-functions">2.20.4. 1.4 Conversion Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-char-thuong-dung-cho-out-put-data">2.20.4.1. <code class="docutils literal notranslate"><span class="pre">To_CHAR</span></code> thường dùng cho out-put data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-num-or-to-date-thuong-dung-cho-in-put-data">2.20.4.2. <code class="docutils literal notranslate"><span class="pre">To_NUM</span></code> or <code class="docutils literal notranslate"><span class="pre">TO_DATE</span></code> thường dùng cho in-put data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#netting-functions">2.20.5. 1.5 Netting Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-functions">2.20.6. 1.6 General Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-expressions">2.20.7. 1.7 Conditional expressions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-rows-aggregate-function">2.21. 2. Multiple-rows/Aggregate Function</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Khổng Tiến Đạt
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>